<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HARMcksL: ARM HAL toolbox (yet STM32 oriented): HARMcksL (release notes)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HARMcksL: ARM HAL toolbox (yet STM32 oriented)<span id="projectnumber">&#160;1.6</span>
   </div>
   <div id="projectbrief">SMFSW collection of HAL hacks for STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">HARMcksL (release notes)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The MIT License (MIT)</p>
<p>Copyright (c) 2017-2024 SMFSW (Sebastien Bizien)</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<h1>v1.6</h1>
<ul>
<li>Doxygen comments review and fixes</li>
<li>UART_term: handling reception of backspace char</li>
<li>RTC_ex: Setting date automatically computes corresponding weekday</li>
<li>RTC_ex: Sets weekday according to STM32 RTC definitions</li>
<li>time_utils: Functions added to get strings of Day and Month</li>
<li>time_utils: Months starts from 1 from now on</li>
<li>WDG_ex: Functions added to get current period of IWDG</li>
<li>WDG_ex: Functions added to save/restore watchdogs configurations</li>
<li>tick_utils: init function returns FctERR instead of HAL_StatusTypeDef</li>
<li>workload: Module added</li>
<li><a class="el" href="struct_p_w_m___i_c.html" title="PWM input capture structure.">PWM_IC</a>: get_PWM_IC_LastUpdate added (useful to evaluate if IC is ongoing and resulting values aren't outdated)</li>
<li>More HAL_ENABLED checks</li>
<li>USB_CDC_IF_ex: USE_USB_CDC_IF_EX symbol check to enable features</li>
<li>TIM_ex: H7 family TIM peripherals handled</li>
</ul>
<h1>v1.5</h1>
<ul>
<li>GPIO_in &amp; <a class="el" href="struct_logic__in.html" title="Logic input structure.">Logic_in</a>: Internal init fix to be in release state (no spurious callback triggered after init)</li>
<li>TIM_ex: fix possible div by 0</li>
<li>ADC_ex: Fixes for compensation when calibrated values differ from VDD_VALUE</li>
<li>ADC_ex: Added customizable pre-processing symbols to allow better ADC configuration when needed (ADC_RESOLUTION, Def_VAlim, Def_VCal, Def_VBatFactor)</li>
<li>ADC_ex: Few more families addressed (whole F G L ranges, H7, U5, WB, WL / missing C0, MP1, H5, WBA)</li>
<li>USB_CDC_IF_ex module added</li>
<li>Fix ADC_cfg template name case</li>
<li>__IO changed to __IOM for struct members (conformance to symbols specifications)</li>
<li>stdream_rdir &amp; UART_term: use of size_t typedef for length parameters</li>
<li>exceptions: HardFault_Handler_callback checks for __CORTEX_M symbol definition and value to add extra informations</li>
<li>Some unneeded assert_param macros removed (when already done later by HAL functions)</li>
<li>TIM_ex: get_TIM_clock refactored (check for bus peripheral CLK)</li>
<li>TIM_ex: get_TIM_clock renamed to RCC_GetTIMCLKFreq</li>
<li>ADC_ex: header comments update (HAL config)</li>
<li>GPIO_in &amp; <a class="el" href="struct_logic__in.html" title="Logic input structure.">Logic_in</a>: Refactored to be using same structure definition (<a class="el" href="struct_logic__in.html" title="Logic input structure.">Logic_in</a> structure extended with data address if needed)</li>
<li><a class="el" href="struct_logic__out.html" title="Logic output structure.">Logic_out</a>: added (logical output abstract of physical layer, may be bit in a variable or a dedicated setter function)</li>
<li>GPIO_out: Refactored to be using <a class="el" href="struct_logic__out.html" title="Logic output structure.">Logic_out</a> module</li>
<li>Logic_ex: former code moved to <a class="el" href="struct_logic__in.html" title="Logic input structure.">Logic_in</a>, now only wrapping <a class="el" href="struct_logic__in.html" title="Logic input structure.">Logic_in</a> &amp; <a class="el" href="struct_logic__out.html" title="Logic output structure.">Logic_out</a> (keeping include compatibility with older versions)</li>
<li>Logic_ex: Masking read value after shifting, otherwise value can be in set state if higher significant bit is set in monitored variable</li>
<li>Logic_ex: Read is done prior to treatment (treatment is executed in the current call of Logic_in_handler without further delay)</li>
<li>WDG_ex: added</li>
<li>WDG_ex: updated to work with single core families (dual core will have to be implemented later)</li>
<li>WDG_ex: fixes for G0 family &amp; WWDG (in general)</li>
<li>WDG_ex: set_IWDG_Period_xx functions added</li>
<li>WDG_ex: added missing peripherals testing in preprocessing</li>
<li>stdream_rdir &amp; UART_Term: sending without using interrupts by default and comments added</li>
<li>stdream_rdir: stdout_no_buffer inline added with comments to explain behaviors</li>
<li>stdream_rdir: fix in __io_putchar code</li>
<li>tick_utils: init function added (for consistency with the use of a TIM instance)</li>
<li>tick_utils: possibility added to use a TIM peripheral instance for us delay generation (for M0/M0+ cores, or on purpose for other cores)</li>
<li>tick_utils: added Delay_ms function</li>
<li>TIM_ex: set_TIM_Tick_Freq added to set a TIM peripheral to get a free running counter with desired tick frequency</li>
<li>UART_Term: UART_Term_Init function added to initialize message queue and launch interrupts (internal code updated)</li>
<li>Doxyfiles updated to reflect changes in Doxygen v1.9.x</li>
</ul>
<h1>v1.4</h1>
<ul>
<li>std libs includes reviewed in all files</li>
<li>strict aliasing types in printf statements</li>
<li>templates: Added folder (with templates and examples)</li>
<li>templates: refactoring of examples</li>
<li>Added cpp preprocessor directives in headers</li>
<li>Doxyfile update</li>
<li>const pointers in functions parameters reviewed (for const pointer, const content or both)</li>
<li>Use of NONNULL__ attribute instead of checking pointer set to value in code</li>
<li>exceptions: Added function to catch last reset source (unfortunately can't be included in sarmfsw lib)</li>
<li>exceptions: Changes using G0 family</li>
<li>exceptions: Added reset sources for L4 family (Get_Reset_Source)</li>
<li>exceptions: Added reset sources for F7, H7 families (Get_Reset_Source)</li>
<li>ADC_ex: Def_VIn &amp; Def_Step moved to header file</li>
<li>ADC_ex: Using ADC_COMPENSATION, Hardware fault may occur at MCU start when average Vref == 0 (not ready), returns 0 for any query in this case</li>
<li>ADC_ex: split slope and reference temp defines</li>
<li>ADC_ex: alias TEMP_CALC_V25... to TEMP_CALC_VTEMP (for legacy use)</li>
<li>ADC_ex: alias &amp; fix for Def_V25... to Def_VTemp (for legacy use)</li>
<li>ADC_ex: merged static ADC_ConvertVal in public ADC_GetConvertedVal</li>
<li>ADC_ex: undef TEMP_CALC_VTEMP for L0/L1 temperature conversion (using calibration values instead)</li>
<li>adc_cfg.h: template update following changes</li>
<li>ADC_ex: Added base ADC module for single ended without injection conversions (with support from ADC_cfg.h in project)</li>
<li>ADC_ex: Added USE_ADC_EX symbol test to enable ADC_ex functions</li>
<li>ADC_ex: Def_VIn automatically computed</li>
<li>ADC_ex: ADC_CALIBRATION &amp; ADC_CALIBRATION set when not available only generates warning now (symbol undef)</li>
<li>ADC_ex: Some conversion calculations changed for various families</li>
<li>CRC_stm32: Added functions to compute and check STM32 CRC using CRC peripheral</li>
<li>flash_check: Added to check flash against computed CRC (using FLASH_SIZE defined in sarmfsw)</li>
<li>GPIO_out: GPIO_out module added</li>
<li>GPIO_out: init variable added in instance to ensure no action before instance properly initialized</li>
<li>GPIO_out: GPIO_OUT_IT can be defined at project level to adapt code for handler called inside TIM interrupt</li>
<li>GPIO_ex: split between GPIO_ex and GPIO_in files (GPIO_in header included in GPIO_ex as a wrapper for all GPIO extensions)</li>
<li>GPIO_ex: On and Off callbacks have pointer to GPIO_in passed as argument (with fix to struct typedef instead of void*)</li>
<li>GPIO_ex: str_GPIO_name optimized</li>
<li>GPIO_ex: refactoring and including stdio.h</li>
<li>GPIO_ex: cut code to Logic_ex to make it generic for both GPIO (working same as before) and any variable <br  />
</li>
<li>Logic_ex: cut from GPIO_ex GPIO_in (and now used by GPIO_in) to have code working to monitor bit in a variable as a logic input signal</li>
<li>Logic_ex: set working elements to 0 at instance init (no need of initialized struct)</li>
<li>PWM: split between PWM and PWM_GPIO files (PWM_GPIO module function and types names refactored)</li>
<li>PWM: Set preload configuration bit when initializing PWM channel</li>
<li>PWM: changed pre-comp test for consistency</li>
<li>PWM: set_PWM_Duty_Scaled calculations now only using integers</li>
<li>PWM: more precision when trying to set TIM frequency (still 16b max)</li>
<li>PMW: logic PWM getters now returns value directly instead of using pointer in function parameters</li>
<li>PWM: added start_polarity parameter in init_PWM_Chan (to ensure there is no glitch with wrong polarity at PWM engine start)</li>
<li>PWM: added clock path for G0 family in get_TIM_clock</li>
<li>PWM: init_PWM_Chan refactored to produce less code and performing more checks not to init undesired or non-existing TIM channel</li>
<li>PWM: set_PWM_Duty_Scaled duty &amp; scale parameters needs to be 32b (for 32b timers TIM2 &amp; TIM5) + computation cast to uint64_t to operate correctly</li>
<li><a class="el" href="struct_p_w_m___i_c.html" title="PWM input capture structure.">PWM_IC</a>: Input capture for PWM input module added</li>
<li><a class="el" href="struct_p_w_m___i_c.html" title="PWM input capture structure.">PWM_IC</a>: Measured Frequency &amp; Duty Cycle getters added</li>
<li><a class="el" href="struct_p_w_m___i_c.html" title="PWM input capture structure.">PWM_IC</a>: Removed active channel 5 &amp; 6 in init_PWM_IC (seems those channels, when available cannot be used for Input Capture)</li>
<li>TIM_ex: PWM file split between TIM_ex &amp; PWM (with functions name refactoring)</li>
<li>TIM_ex: set_TIM_Freq handling for TIM2 &amp; TIM5 32b range period (increasing output duty cycle accuracy depending requested freq)</li>
<li>TIM_ex: get_TIM_clock not static (can be used to get TIM reference clock when needed)</li>
<li>TIM_ex: write_TIM_CCR CCR_val needs to be 32b (for 32b timers TIM2 &amp; TIM5)</li>
<li>stdream_rdir &amp; UART_term: refactoring</li>
<li>stdream_rdir: added pre-comp option for ITM</li>
<li>tick_utils: Delay_us added</li>
<li>tick_utils: Delay_us disabled on cortex M0/M0+ (no DWT peripheral)</li>
<li>tick_utils: Fix core debug trace not necessarily enabled</li>
<li>time_utils: Added functions to determine if leap year and weekday for a given date</li>
<li>UART_term: dissociated HAL &amp; UART Term callbacks (to be able to call UART Term callbacks in project from HAL callbacks with multiple busses to handle)</li>
<li>pattern2D: removed (now part of sarmfsw in arm_inlines_linearization.h)</li>
<li>stdream_rdir &amp; UART_term: total overhaul (using syscalls to write data to stream). Backward compatibility kept, yet discouraged with a warning</li>
<li>stdream_rdir &amp; UART_term: code cleanup, preprocessor directives fix and standard lib includes reviewed</li>
<li>stdream_rdir: some code added (not activated) &amp; refactoring for syscalls use of input UART stream (only for test, not working, and not that relevant... Maybe removed soon)</li>
<li>stdream_rdir: interrupt driven disabled for UART_TX when using syscalls redirection</li>
<li>UART_term: no watchdog refresh while waiting for UART to be ready in UART_Term_Wait_Ready</li>
</ul>
<h1>v1.3</h1>
<ul>
<li>Adding support for doxygen documentation generation with Travis CI</li>
<li>added const qualifier to more function parameters</li>
<li>pattern2d: added linearization patterns</li>
<li>UART_term &amp; stdream_rdir: use UART_REDIRECT define to enable UART redirection</li>
<li>uart_term: SERIAL_DBG_Wait_Ready returns ERROR_NOTAVAIL when UART not initialized</li>
<li>stdream_rdir: test of SERIAL_DBG_Wait_Ready before sending message (prevents errors when UART is not yet initialized)</li>
<li>stdream_rdir: renamed ITM_ENABLED to ITM_REDIRECT for consistency with UART_REDIRECT symbol</li>
<li>PWM: added case where duty cycle == scale in set_PWM_Duty_Scaled (to achieve real 100% duty cycles)</li>
<li>PWM: check if scale is equal 0 in set_PWM_Duty_Scaled (to avoid Division by 0)</li>
<li>GPIO_ex: added gpio logic and possible callbacks when input set / reset</li>
<li>GPIO_ex: removed eActOut (replaced by eGPIOstate in sarmfsw lib)</li>
<li>exceptions: removed erroneous dump_stack macro (functions will now be in stack_utils)</li>
<li>exceptions: dumpStack renamed to print_exception_stack, now static to <a class="el" href="exceptions_8c.html" title="Debug tool helpers.">exceptions.c</a></li>
<li>stack_utils: new module to get informations from global registers &amp; stack</li>
<li>stack_utils: stack_dump now refactored to work fine</li>
<li>random_utils: new rand wrapper module to enhance randomness some more</li>
</ul>
<h1>v1.2</h1>
<ul>
<li>removed peripheral includes (already done by sarmfsw library)</li>
<li>removed FctERR module (and calls to header) which is now part of sarmfsw</li>
<li>PWM: fixed possible warning in for loop</li>
<li>PWM: fixed frequency calculation when PLL clock source used (STM32F3)</li>
<li>PWM: added emulated PWM functionality &amp; added config sub-struct (for low frequency PWM generation on GPIO)</li>
<li>stdream_rdir: refactoring &amp; removed get_fp_dec (now in sarmfsw)</li>
<li>UART_term: added UART terminal hacks</li>
<li>RTC_ex: added some helper functions for RTC peripheral</li>
<li>time_utils: some functions to deal with time_t</li>
<li>ERR_xx refactored to ERROR_xx</li>
</ul>
<h1>v1.1</h1>
<ul>
<li>PWM: Fixed start/stop PWM channels all at once</li>
<li>PWM: check for clock path following STM family used</li>
<li>PWM: Added APB clock automatic scaling for TIM used (clock fed for frequency calculation)</li>
<li>PWM: Added function to initialize TIM base and start its period elapsed interruptions</li>
<li>PWM: Added inline to start/stop TIM module period elapsed interruptions</li>
<li>stddream_rdir: added UNUSED macro when needed to avoid variable unused compilation warnings</li>
<li>Removed CMSIS &amp; HAL includes from files (already included by sarmfsw library)</li>
</ul>
<h1>v1.0</h1>
<ul>
<li>PWM: Added function init_PWM_Chan (calls setFreq &amp; starts PWM channel output)</li>
<li>PWM: Added inline to Start/Stop PWM channel output</li>
<li>PWM: added precomp define (from sarmfsw) to define channel 5 &amp; 6 only for F3 (may be needed on some other families)</li>
<li>FctERR: enum is now signed and precomp defined(lwip) in enum discards duplicates with lwip (while keeping common values)</li>
</ul>
<h1>v0.7 and below</h1>
<ul>
<li>initial commit and beta versions </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
